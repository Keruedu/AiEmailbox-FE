# AI Email Box - React Email Client with Gmail Integration & Kanban Workflow

A modern, secure email dashboard application that integrates with **Gmail API** (Track A) to provide a real-time email experience with **Kanban-style workflow management**. Built with **Go (Gin)** backend and **Next.js** frontend, featuring AI-powered email summarization.

## Deployed Public URLs

- **Frontend**: https://ai-emailbox-fe.vercel.app
- **Backend**: https://aiemailbox-be-go.onrender.com

## Project Overview

This project extends the **"React Email Client with Gmail / IMAP/POP3 Integration"** (Track A) with advanced workflow management features:

### Core Features (Week 1)

- Google Cloud Project with Gmail API enabled
- OAuth2 Authentication with auto-refresh tokens
- Real-time email synchronization from Gmail
- Email list with pagination, unread/starred indicators
- Email detail view with HTML rendering and attachments
- Compose and send emails

### New Kanban Features (Week 2)

- Kanban Board Interface
- Drag-and-Drop
- Snooze/Deferral Mechanism
- AI Content Summarization
- View Toggle

## Setup Instructions

### 1. Google Cloud Setup & OAuth Credentials

To run this project, you need to create Google OAuth credentials:

1.  Go to [Google Cloud Console](https://console.cloud.google.com/).
2.  Create a new project.
3.  **Enable Gmail API**: Go to "APIs & Services" > "Library", search for "Gmail API" and enable it.
4.  **Configure OAuth Consent Screen**:
    - Go to "APIs & Services" > "OAuth consent screen".
    - User Type: **External** (or Internal if you have a Workspace).
    - Scopes: Add `.../auth/gmail.readonly`, `.../auth/gmail.modify`, `.../auth/gmail.send`, `email`, `profile`.
    - Test Users: Add your email address (required for External app in testing mode).
5.  **Create Credentials**:
    - Go to "APIs & Services" > "Credentials".
    - Click "Create Credentials" > "OAuth client ID".
    - Application type: **Web application**.
    - Name: `AI Email Box Local`.
    - **Authorized JavaScript origins**: `http://localhost:3000`
    - **Authorized redirect URIs**: `http://localhost:3000` (The frontend handles the callback).
    - Copy the **Client ID** and **Client Secret**.

### 2. Setup MongoDB

**Option A: Local MongoDB**

```bash
# Install MongoDB Community Edition
# Start MongoDB service
mongod --dbpath /path/to/data/db
```

**Option B: MongoDB Atlas (Cloud)** _(Recommended)_

1.  Go to [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2.  Create a free cluster
3.  Whitelist your IP address (or allow all: `0.0.0.0/0` for development)
4.  Create a database user
5.  Get connection string: `mongodb+srv://username:password@cluster.mongodb.net/`

### 3. Start Backend

```bash
cd AiEmailbox-BE-GO

# Create .env file
cp .env.example .env

# Update .env with your credentials:
# PORT=8080
# MONGODB_URI=mongodb://localhost:27017  # or MongoDB Atlas URI
# MONGODB_DATABASE=aiemailbox
# GOOGLE_CLIENT_ID=<your-google-client-id>
# GOOGLE_CLIENT_SECRET=<your-google-client-secret>
# FRONTEND_URL=http://localhost:3000
# JWT_SECRET=<random-secret-string>
# JWT_ACCESS_EXPIRATION=15m
# JWT_REFRESH_EXPIRATION=168h

# Run server
go run -mod=vendor cmd/server/main.go
```

Backend runs on `http://localhost:8080`

API documentation available at: `http://localhost:8080/swagger/index.html`

### 4. Start Frontend

```bash
cd AiEmailbox-FE

# Install dependencies
npm install

# Create .env file
cp .env.example .env

# Update .env:
# NEXT_PUBLIC_API_URL=http://localhost:8080/api
# NEXT_PUBLIC_GOOGLE_CLIENT_ID=<your-google-client-id>  # Same as backend

# Run development server
npm run dev
```

Frontend runs on `http://localhost:3000`

## Kanban Implementation Architecture

### Data Flow

1.  **Frontend** calls `kanbanService.getKanban()` to fetch all emails grouped by status
2.  **Backend** queries Gmail API and organizes emails into columns based on labels
3.  **Drag-and-drop** triggers `kanbanService.moveCard(emailId, newStatus)`
4.  **Backend** updates Gmail label for that email
5.  **Frontend** optimistically updates UI, then refreshes on success

### Status Management via Gmail Labels

The Kanban workflow leverages Gmail's native labeling system:

- **inbox** â†’ Inbox column
- **todo** / **to_do** â†’ To Do column
- **in_progress** / **in-progress** â†’ In Progress column
- **done** â†’ Done column
- **snoozed** â†’ Snoozed column

When a card is moved between columns, the backend modifies the email's Gmail labels accordingly.

### Snooze Mechanism

- **Snooze Date Storage**: Stored in MongoDB or as a custom Gmail label with timestamp
- **Restoration Logic**: Backend background job periodically checks for expired snoozes
- **Manual Trigger**: Users can also click "Refresh" to force check

### AI Summarization

- **API Endpoint**: `POST /api/kanban/summarize`
- **LLM Integration Points**: OpenAI API, Google Gemini, or Claude
- **Caching**: Summaries are stored after first generation to avoid repeated API calls
- **Display**: Summary shown in card preview, togglable with original content

## Project Structure

```
.ai-emailbox-final-project/
â”œâ”€â”€ AiEmailbox-BE-GO/              # Backend (Go)
â”‚   â”œâ”€â”€ cmd/server/                # Application entry point
â”‚   â”‚   â””â”€â”€ main.go                # Server setup and routing
â”‚   â”œâ”€â”€ config/                    # Configuration management
â”‚   â”‚   â””â”€â”€ config.go              # Environment variables
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ database/              # Database connection
â”‚   â”‚   â”‚   â””â”€â”€ mongodb.go
â”‚   â”‚   â”œâ”€â”€ handlers/              # HTTP request handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.go            # Authentication endpoints
â”‚   â”‚   â”‚   â””â”€â”€ email.go           # Email & Kanban endpoints
â”‚   â”‚   â”œâ”€â”€ middleware/            # HTTP middleware
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.go            # JWT verification
â”‚   â”‚   â”‚   â””â”€â”€ cors.go            # CORS configuration
â”‚   â”‚   â”œâ”€â”€ models/                # Data models
â”‚   â”‚   â”‚   â”œâ”€â”€ email.go           # Email structures
â”‚   â”‚   â”‚   â””â”€â”€ user.go            # User structures
â”‚   â”‚   â”œâ”€â”€ repository/            # Database layer
â”‚   â”‚   â”‚   â”œâ”€â”€ email_repository.go
â”‚   â”‚   â”‚   â””â”€â”€ user_repository.go
â”‚   â”‚   â”œâ”€â”€ services/              # Business logic
â”‚   â”‚   â”‚   â””â”€â”€ gmail_service.go   # Gmail API integration
â”‚   â”‚   â””â”€â”€ utils/                 # Helper functions
â”‚   â”‚       â”œâ”€â”€ jwt.go             # JWT utilities
â”‚   â”‚       â””â”€â”€ password.go        # Password hashing
â”‚   â”œâ”€â”€ docs/                      # Swagger documentation
â”‚   â”œâ”€â”€ .env                       # Environment variables
â”‚   â””â”€â”€ go.mod                     # Go dependencies
â”‚
â””â”€â”€ AiEmailbox-FE/                 # Frontend (Next.js)
   â”œâ”€â”€ src/
   â”‚   â”œâ”€â”€ app/                   # Next.js app router
   â”‚   â”‚   â”œâ”€â”€ components/        # Page-specific components
   â”‚   â”‚   â”‚   â”œâ”€â”€ EmailDetail.tsx
   â”‚   â”‚   â”‚   â””â”€â”€ Kanban/        # Kanban view components
   â”‚   â”‚   â”‚       â”œâ”€â”€ KanbanBoard.tsx    # Main board
   â”‚   â”‚   â”‚       â”œâ”€â”€ KanbanColumn.tsx   # Column component
   â”‚   â”‚   â”‚       â””â”€â”€ KanbanCard.tsx     # Card with snooze & summarize
   â”‚   â”‚   â”œâ”€â”€ inbox/             # Inbox page
   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx       # List/Kanban toggle
   â”‚   â”‚   â”œâ”€â”€ login/             # Login page
   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
   â”‚   â”‚   â”œâ”€â”€ layout.tsx         # Root layout
   â”‚   â”‚   â””â”€â”€ page.tsx           # Home page
   â”‚   â”œâ”€â”€ components/            # Shared components
   â”‚   â”‚   â”œâ”€â”€ ComposeModal.tsx   # Email composition
   â”‚   â”‚   â””â”€â”€ ProtectedRoute.tsx # Auth guard
   â”‚   â”œâ”€â”€ contexts/              # React contexts
   â”‚   â”‚   â””â”€â”€ AuthContext.tsx    # Authentication state
   â”‚   â”œâ”€â”€ services/              # API services
   â”‚   â”‚   â”œâ”€â”€ api.ts             # Axios client with interceptors
   â”‚   â”‚   â”œâ”€â”€ auth.ts            # Auth API calls
   â”‚   â”‚   â”œâ”€â”€ email.ts           # Email API calls
   â”‚   â”‚   â””â”€â”€ kanbanService.ts   # Kanban API calls
   â”‚   â”œâ”€â”€ types/                 # TypeScript types
   â”‚   â”‚   â”œâ”€â”€ auth.ts
   â”‚   â”‚   â””â”€â”€ email.ts
   â”‚   â””â”€â”€ mocks/                 # Mock data (for development)
   â”œâ”€â”€ public/                    # Static assets
   â”œâ”€â”€ .env                       # Environment variables
   â”œâ”€â”€ package.json               # Node dependencies
   â””â”€â”€ tsconfig.json              # TypeScript config
```

## Quick Start Guide

1.  **Setup Google Cloud credentials** (see section 1 above)
2.  **Start MongoDB** (local or Atlas)
3.  **Configure backend** `.env` with Google credentials
4.  **Start backend**: `cd AiEmailbox-BE-GO && go run -mod=vendor cmd/server/main.go`
5.  **Configure frontend** `.env` with API URL and Google Client ID
6.  **Start frontend**: `cd AiEmailbox-FE && npm install && npm run dev`
7.  **Navigate to** `http://localhost:3000`
8.  **Login with Google** and grant permissions
9.  **Toggle to Kanban view** to see workflow management features

## Feature Implementation Details

### I. Kanban Interface Visualization âœ…

**Implementation**: Web interface that organizes email data into a Kanban board layout.

**Columns**:

- **Inbox** (ğŸ“¥) - New incoming emails
- **To Do** (âš¡) - Emails marked for action
- **In Progress** (ğŸ”„) - Currently being worked on
- **Done** (âœ…) - Completed emails
- **Snoozed** (ğŸ’¤) - Temporarily deferred emails

**Features**:

- Each email is displayed as a visual "Card" with sender avatar, subject, and preview
- Real email data fetched from Gmail API via backend
- Column headers show count badges
- Responsive design with horizontal scrolling
- Color-coded columns for visual distinction

**Files**:

- `AiEmailbox-FE/src/app/components/Kanban/KanbanBoard.tsx` - Main board orchestration
- `AiEmailbox-FE/src/app/components/Kanban/KanbanColumn.tsx` - Column rendering
- `AiEmailbox-FE/src/app/components/Kanban/KanbanCard.tsx` - Card components
- `AiEmailbox-FE/src/services/kanbanService.ts` - API integration

### II. Workflow Management (Drag-and-Drop) âœ…

**Implementation**: Drag-and-drop functionality using `@dnd-kit` library for intuitive email workflow management.

**Features**:

- Drag email cards from any column to another
- Visual feedback during drag (opacity change, drag overlay)
- Smooth animations and transitions
- Optimistic UI updates (immediate visual feedback)
- Backend API call to persist status changes
- Automatic revert on failure

**Technical Details**:

- Uses `@dnd-kit/core` for drag-and-drop context
- `@dnd-kit/sortable` for sortable cards within columns
- `PointerSensor` and `KeyboardSensor` for accessibility
- Backend endpoint: `POST /api/kanban/move` with `{ email_id, to_status }`

**Files**:

- `AiEmailbox-FE/src/app/components/Kanban/KanbanBoard.tsx` - DnD context and handlers
- `AiEmailbox-FE/package.json` - Dependencies: `@dnd-kit/core`, `@dnd-kit/sortable`, `@dnd-kit/utilities`

### III. Snooze / Deferral Mechanism âœ…

**Implementation**: Snooze feature that temporarily removes emails from active view until a specified time.

**Features**:

- Clock icon (ğŸ•) on each card opens snooze popover
- Preset snooze options:
- **Later Today** (+4 hours)
- **Tomorrow** (9 AM next day)
- **Next Week** (Monday 9 AM)
- **In 1 minute** (testing mode)
- Snoozed emails move to "Snoozed" column
- Automatic restoration to original context when snooze expires
- Backend monitors snooze duration and updates status
- Visual indicator shows snooze end time

**Technical Details**:

- Uses `dayjs` library for date/time calculations
- Backend endpoint: `POST /api/kanban/snooze` with `{ email_id, until }`
- `until` parameter accepts RFC3339 timestamp
- Background job checks for expired snoozes and restores emails

**Files**:

- `AiEmailbox-FE/src/app/components/Kanban/KanbanCard.tsx` - Snooze UI (SnoozePopover component)
- `AiEmailbox-FE/package.json` - Dependency: `dayjs` for time handling

### IV. Content Summarization Integration âœ…

**Implementation**: AI-powered email summarization for quick decision-making without reading full content.

**Features**:

- "TÃ³m táº¯t AI" (AI Summarize) button with robot icon (ğŸ¤–) on each card
- Generates concise summaries via LLM API integration
- Toggle between summary and original preview
- Visual indicator (âœ¨ AI Summary) when showing summarized content
- "Xem chi tiáº¿t" (View Details) button opens full email in modal
- Click on card navigates to original Gmail link (optional enhancement)
- Persistent summary storage (cached after first generation)

**Technical Details**:

- Backend endpoint: `POST /api/kanban/summarize` with `{ email_id }`
- Returns: `{ ok: boolean, summary: string }`
- Integration ready for OpenAI/Gemini/Claude APIs
- Frontend displays summary in card preview area
- Loading state with spinner during generation

**Files**:

- `AiEmailbox-FE/src/app/components/Kanban/KanbanCard.tsx` - Summary button and display logic
- `AiEmailbox-FE/src/services/kanbanService.ts` - API call to summarize endpoint

### ğŸ” Authentication & Security (Track A)

- **Google OAuth2**: Implements **Authorization Code Flow**
- **Auto-Refresh**: Seamless token rotation without user interruption
- **Secure Token Storage**:
- Access tokens in memory (React state)
- Refresh tokens in localStorage
- Google refresh tokens in MongoDB (backend only)

### ğŸ“§ Email Dashboard

- **Mailboxes**: Fetches real labels from Gmail (Inbox, Sent, Trash, etc.)
- **Email List**: Pagination, Unread/Starred indicators
- **Email Detail**: HTML rendering, Attachments, Reply functionality
- **Compose**: Send new emails with rich text support

## Tech Stack

### Backend

- **Framework**: Go (Golang) with Gin web framework
- **Database**: MongoDB (Cloud: MongoDB Atlas)
- **Authentication**: JWT with refresh token rotation
- **Gmail Integration**: Google API Client for Go
- **API Documentation**: Swagger/OpenAPI

### Frontend

- **Framework**: Next.js 15 (App Router)
- **UI Library**: React 19
- **Language**: TypeScript
- **Components**: Ant Design (antd)
- **Drag & Drop**: @dnd-kit (core, sortable, utilities)
- **HTTP Client**: Axios with interceptors
- **Styling**: Tailwind CSS + Custom CSS
- **Date Handling**: dayjs
- **OAuth**: @react-oauth/google

### DevOps & Deployment

- **Frontend Hosting**: Vercel
- **Backend Hosting**: Render
- **Database**: MongoDB Atlas (Cloud)

### Key Dependencies

**Frontend** (`AiEmailbox-FE/package.json`):

```json
{
  "@dnd-kit/core": "^6.3.1", // Drag-and-drop core
  "@dnd-kit/sortable": "^10.0.0", // Sortable containers
  "@dnd-kit/utilities": "^3.2.2", // DnD utilities
  "antd": "^5.29.1", // UI components
  "axios": "^1.13.2", // HTTP client
  "dayjs": "^1.11.19", // Date/time handling
  "next": "16.0.3", // React framework
  "react": "19.2.0", // UI library
  "@react-oauth/google": "^0.12.2" // Google OAuth
}
```

**Backend** (`AiEmailbox-BE-GO/go.mod`):

```go
github.com/gin-gonic/gin              // Web framework
go.mongodb.org/mongo-driver           // MongoDB driver
github.com/golang-jwt/jwt             // JWT tokens
google.golang.org/api/gmail/v1        // Gmail API
github.com/joho/godotenv              // Environment variables
github.com/swaggo/gin-swagger         // API documentation
```

---

**Advanced Web Development Course**

---
